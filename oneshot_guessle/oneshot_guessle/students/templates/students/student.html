{% extends 'base.html' %}
{% load static %}

{% block content %}
<!-- Add HTML code between these tags-->

<h1 class="text-light">Hi, {{user.username}}</h1>
<br>


<div class="container">
    <hr>
    <h3 class="text-light">Analysis of all weekly tests</h3>
    <table class="table table-dark table-striped">
        {% if user.user_profile.exam_yr == 13 %}
        <thead class="table-dark">
            <th scope="col">1.1 Input & Output </th>
            <th scope="col">1.2 Software & Development</th>
            <th scope="col">1.3 Exchanging Data</th>
            <th scope="col">1.4 Datatypes & Algorithms</th>
            <th scope="col">1.5 legal & moral issues</th>
            <th scope="col">2.1 Computation Thinking</th>
            <th scope="col">2.2 Problem Solving</th>
            <th scope="col">%</th>
            <th scope="col">Rank in cohort</th>
        </thead>
        {% else %}
        <thead class="table-dark">
            <th scope="col">1. Algorithms</th>
            <th scope="col">2. Programming</th>
            <th scope="col">3. Computer Systems</th>
            <th scope="col">4. Data rep</th>
            <th scope="col">5. Security</th>
            <th scope="col">6. Networks</th>
            <th scope="col">7. ethics & Leg</th>
            <th scope="col">%</th>
            <th scope="col">Rank in cohort</th>
        </thead>
        {% endif %}
        <tbody>
            <tr>    
                <td>{{analysis.atopic1}}%</td>
                <td>{{analysis.atopic2}}%</td>
                <td>{{analysis.atopic3}}%</td>
                <td>{{analysis.atopic4}}%</td>
                <td>{{analysis.atopic5}}%</td>
                <td>{{analysis.atopic6}}%</td>
                <td>{{analysis.atopic7}}%</td>
                <td>{{analysis.aAv}}%</td>
                <td>{{analysis.aRank}}</td>
            </tr>
        </tbody>
      </table>

    <br>

    <h3 class="text-light">Results of weekly tests</h3>
    <table class="table table-dark table-striped">
        {% if user.user_profile.exam_yr == 13 %}
        <thead class="table-dark">
            <th scope="col">Test No</th>
            <th scope="col" class="center col-small">1.1 Input & Output </th>
            <th scope="col" class="center col-small">1.2 Software & Development</th>
            <th scope="col" class="center col-small">1.3 Exchanging Data</th>
            <th scope="col" class="center col-small">1.4 Datatypes & Algorithms</th>
            <th scope="col" class="center col-small">1.5 Legal & moral issues</th>
            <th scope="col" class="center col-small">2.1 Computation Thinking</th>
            <th scope="col" class="center col-small">2.2 Problem Solving</th>
            <th scope="col" class="center col-small">%</th>
            <th scope="col">Rank in cohort</th>
        </thead>
        {% else %}
        <thead class="table-dark">
            <th scope="col">Test No</th>
            <th scope="col" class="center col-small">1. Algorithms</th>
            <th scope="col" class="center col-small">2. Programming</th>
            <th scope="col" class="center col-small">3. Computer Systems</th>
            <th scope="col" class="center col-small">4. Data rep</th>
            <th scope="col" class="center col-small">5. Security</th>
            <th scope="col" class="center col-small">6. Networks</th>
            <th scope="col" class="center col-small">7. Ethics & Leg</th>
            <th scope="col" class="center col-small">%</th>
            <th scope="col">Rank in cohort</th>
        </thead>
        {% endif %}
        <tbody>
            {% for test in tests %}
                <tr>
                    <th scope="row">{{test.testNO}}</th>
                    <td class="center col-small">{{test.topic1|floatformat}}%</td>
                    <td class="center col-small">{{test.topic2|floatformat}}%</td>
                    <td class="center col-small">{{test.topic3|floatformat}}%</td>
                    <td class="center col-small">{{test.topic4|floatformat}}%</td>
                    <td class="center col-small">{{test.topic5|floatformat}}%</td>
                    <td class="center col-small">{{test.topic6|floatformat}}%</td>
                    <td class="center col-small">{{test.topic7|floatformat}}%</td>
                    <td class="center col-small">{{test.total}}%</td>
                    <td>{{test.rank}}</td>
                </tr>
            {% endfor %}
        </tbody>
      </table>

    <br>

    <br>
    
    <div class="card text-bg-dark">
        <div class="card-body">
            <canvas id="pie-chart"></canvas>
        </div>
      </div>
    
    <br>

    <h3 class="text-light">Results of mock tests</h3>
    <table class="table table-dark table-striped">
        {% if user.user_profile.exam_yr == 13 %}
        <thead class="table-dark">
            <th scope="col">Test Name</th>
            <th scope="col" class="center col-small">1.1 Input & Output </th>
            <th scope="col" class="center col-small">1.2 Software & Development</th>
            <th scope="col" class="center col-small">1.3 Exchanging Data</th>
            <th scope="col" class="center col-small">1.4 Datatypes & Algorithms</th>
            <th scope="col" class="center col-small">1.5 legal & moral issues</th>
            <th scope="col" class="center col-small">2.1 Computation Thinking</th>
            <th scope="col" class="center col-small">2.2 Problem Solving</th>
            <th scope="col" class="center col-small">%</th>
            <th scope="col">Rank in cohort</th>
        </thead>
        {% else %}
        <thead class="table-dark">
            <th scope="col">Test Name</th>
            <th scope="col" class="center col-small">1. Algorithms</th>
            <th scope="col" class="center col-small">2. Programming</th>
            <th scope="col" class="center col-small">3. Computer Systems</th>
            <th scope="col" class="center col-small">4. Data rep</th>
            <th scope="col" class="center col-small">5. Security</th>
            <th scope="col" class="center col-small">6. Networks</th>
            <th scope="col" class="center col-small">7. Ethics & Leg</th>
            <th scope="col" class="center col-small">%</th>
            <th scope="col">Rank in cohort</th>
        </thead>
        {% endif %}
        <tbody>
            {% for test in mock_table %}
            <tr>
                <th scope="row">{{test.testName}}</th>
                <td class="center col-small">{{test.topic1|floatformat}}%</td>
                <td class="center col-small">{{test.topic2|floatformat}}%</td>
                <td class="center col-small">{{test.topic3|floatformat}}%</td>
                <td class="center col-small">{{test.topic4|floatformat}}%</td>
                <td class="center col-small">{{test.topic5|floatformat}}%</td>
                <td class="center col-small">{{test.topic6|floatformat}}%</td>
                <td class="center col-small">{{test.topic7|floatformat}}%</td>
                <td class="center col-small">{{test.total}}%</td>
                <td>{{test.rank}}</td>
            </tr>
            {% endfor %}
        </tbody>
      </table>
    

</div>




{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<script>

    const config = {
        type: 'line',
        data: {
            labels: {{ labels|safe }},
            datasets: [{
                label: 'Test % (higher is better)',
                data: {{ chart_data|safe }},
                fill: false,
                borderColor: 'rgb(75, 192, 192)',
                tension: 0.3
            },
            {
                label: 'Rank (lower is better)',
                data: {{ chart_rank|safe }},
                fill: false,
                borderColor: 'rgb(255, 99, 132)',
                tension: 0.3
            }
        
        }
    };

    window.onload = function() {
      var ctx = document.getElementById('pie-chart').getContext('2d');
      window.myPie = new Chart(ctx, config);
    };

  </script>
{% endblock %}